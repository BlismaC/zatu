<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZATU.IO</title>
    <style>
        /* General HTML and Body styles */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%; /* Ensure html and body take full height */
            overflow: hidden; /* Hide any potential scrollbars */
            font-family: sans-serif; /* A nice default font */
            display: flex; /* Use flexbox for centering */
            justify-content: center;
            align-items: center;
            background-color: #333; /* Dark background for the menu screen */
        }
        /* Canvas styles */
        #gameCanvas {
            display: block;
            width: 100vw; /* Take full viewport width */
            height: 100vh; /* Take full viewport height */
            cursor: crosshair;
            background-color: #578a34; /* Ensure canvas background matches game background */
            position: absolute; /* Position it behind other elements */
            top: 0;
            left: 0;
            z-index: 1; /* Lowest z-index, always visible */
            /* background-color is now handled by client.js for dynamic world drawing */
        }
        /* Main Menu Background */
        #mainMenuBackground {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            /* Placeholder image for main menu background - replace with your direct image URL */
            background-image: url('https://placehold.co/1920x1080/333/FFF?text=Game+Background');
            background-size: cover; /* Cover the entire area */
            background-position: center; /* Center the image */
            z-index: 2; /* Higher than canvas (1), lower than mainMenu (100) */
            display: block; /* Visible by default on initial page load */
        }
        /* Styling for the main menu container */
        .menu-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Now transparent to show either mainMenuBackground or gameCanvas */
            background: transparent;
            padding: 40px;
            border-radius: 15px; /* More rounded */
            text-align: center;
            z-index: 100; /* Stays on top */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4); /* More pronounced shadow */
            border: 1px solid rgba(255, 255, 255, 0.1); /* Subtle white border */
            color: #EEE; /* Text color for menu items */
        }
        /* Main Menu Title */
        h1 {
            color: white;
            margin-top: 0;
            margin-bottom: 25px; /* Added from style.css */
            font-size: 4em; /* Larger title */
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            letter-spacing: 2px;
        }
        /* Player Name Input */
        #playerNameInput {
            font-size: 1.2em;
            padding: 12px 15px; /* Slightly more padding */
            border-radius: 8px; /* Slightly rounded */
            border: 1px solid #666; /* Darker border */
            background-color: #333; /* Darker input background */
            color: white;
            width: 80%;
            max-width: 280px; /* Slightly wider */
            margin-bottom: 20px;
            box-sizing: border-box;
            text-align: center; /* Center placeholder text */
            outline: none; /* Remove default outline */
            transition: border-color 0.2s; /* Smooth transition for focus */
        }
        #playerNameInput::placeholder {
            color: #bbb; /* Lighter placeholder */
        }
        #playerNameInput:focus {
            border-color: #777; /* Darker border on focus */
        }
        /* Start Game Button */
        #startGameButton {
            font-size: 1.6em; /* Slightly larger button text */
            padding: 15px 30px; /* More padding */
            border-radius: 10px; /* More rounded */
            border: none; /* No border */
            background-color: #74B37C; /* Moomoo.io green */
            color: white;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s; /* Smooth transitions */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Button shadow */
        }
        #startGameButton:hover {
            background-color: #66996E; /* Darker green on hover */
            transform: translateY(-2px); /* Slight lift effect */
        }
        #startGameButton:active {
            transform: translateY(0); /* Press effect */
        }

        /* Resource Counter Styles - Custom CSS based on Moomoo.io image */
        #resourceCounterContainer {
            position: absolute;
            /* Adjusted position to be less close to the corner, based on scaled offsets */
            bottom: 30px; /* BLOCK_BOTTOM_OFFSET scaled */
            right: 30px;  /* BLOCK_RIGHT_OFFSET scaled */
            display: none; /* Hidden by default in CSS to prevent flicker, JavaScript will show it */
            flex-direction: column; /* Stack vertically */
            gap: 20px; /* Adjusted gap to match new size (was 24px) */
            z-index: 50; /* Below main menu, above canvas */
        }
        .resource-item {
            display: flex;
            align-items: center;
            /* Adjusted padding to make boxes shorter and less "long" */
            padding: 7px 15px; /* Reduced from 9px 18px for smaller size */
            background-color: rgba(45, 60, 45, 0.85); /* COUNTER_BACKGROUND_COLOR */
            border-radius: 5px; /* COUNTER_BORDER_RADIUS */
            color: white; /* COUNTER_TEXT_COLOR */
            font-size: 40px; /* Reduced from 48px for smaller size */
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            white-space: nowrap; /* Prevent numbers from wrapping */
            min-width: 90px; /* Slightly reduced min-width */
            justify-content: flex-end; /* Align content to the right */
        }
        .resource-item span {
            /* Numbers will push left as they grow due to flex-end on parent and img margin */
        }
        .resource-item img {
            width: 40px; /* Reduced from 48px for smaller size */
            height: 40px; /* Reduced from 48px for smaller size */
            margin-left: 10px; /* Adjusted margin to match new size (was 12px) */
            object-fit: contain; /* Ensures image scales without distortion */
            image-rendering: pixelated; /* For sharper pixel art if source allows */
        }

        /* NEW: Styles for the standalone gold display */
        #goldResourceDisplay {
            position: absolute;
            bottom: 180px; /* Minimap bottom (20px) + Minimap size (150px) + 10px gap */
            left: 20px; /* Align with minimap's left padding */
            /* Explicitly set to flex to ensure visibility by default */
            display: flex;
            /* Reuse .resource-item styles by including them here directly or via a class */
            background-color: rgba(45, 60, 45, 0.85);
            border-radius: 5px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            white-space: nowrap;
            padding: 7px 15px;
            min-width: 90px;
            align-items: center;
            justify-content: flex-end;
        }
        #goldResourceDisplay img {
            width: 40px;
            height: 40px;
            margin-left: 10px;
            object-fit: contain;
            image-rendering: pixelated;
        }
    </style>
</head>
<body>
    <!-- Game Canvas -->
    <canvas id="gameCanvas"></canvas>

    <!-- Main Menu Background -->
    <div id="mainMenuBackground"></div>

    <!-- Main Menu -->
    <div id="mainMenu" class="menu-container">
        <h1>ZATU.IO</h1>
        <input type="text" id="playerNameInput" placeholder="Enter your name">
        <button id="startGameButton">Start Game</button>
    </div>

    <!-- Resource Counter Container (for wood, stone, etc.) -->
    <div id="resourceCounterContainer">
        <!-- Resource items will be dynamically added here by JavaScript -->
        <!-- Example structure for a resource item: -->
        <!--
        <div class="resource-item">
            <span id="woodCount">0</span>
            <img src="https://placehold.co/48x48/8B4513/FFF?text=Wood" alt="Wood Icon">
        </div>
        -->
    </div>

    <!-- Gold Resource Display (NEW) -->
    <div id="goldResourceDisplay">
        <span id="goldCount">0</span>
        <img src="https://placehold.co/40x40/FFD700/000?text=Gold" alt="Gold Icon">
    </div>

    <!-- Local Chat Input -->
    <input type="text" id="localChatInput" placeholder="Type to chat..." style="
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        width: 300px;
        padding: 10px;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        border: 1px solid #555;
        border-radius: 5px;
        font-size: 1em;
        z-index: 101; /* Above main menu */
        opacity: 0; /* Hidden by default */
        pointer-events: none; /* Not interactive when hidden */
        transition: opacity 0.2s ease-in-out;
    ">

    <script>
        // JavaScript for game logic would go here
        // For now, simple menu handling
        const mainMenu = document.getElementById('mainMenu');
        const mainMenuBackground = document.getElementById('mainMenuBackground');
        const gameCanvas = document.getElementById('gameCanvas');
        const startGameButton = document.getElementById('startGameButton');
        const playerNameInput = document.getElementById('playerNameInput');
        const resourceCounterContainer = document.getElementById('resourceCounterContainer');
        const goldResourceDisplay = document.getElementById('goldResourceDisplay');
        const goldCountSpan = document.getElementById('goldCount'); // Get reference to the span inside goldResourceDisplay

        // Initially show the main menu
        mainMenu.style.display = 'flex';
        mainMenuBackground.style.display = 'block';
        gameCanvas.style.display = 'none'; // Hide canvas until game starts
        resourceCounterContainer.style.display = 'none'; // Hide resource counters initially
        // The goldResourceDisplay is set to 'flex' by CSS, so it should be visible by default
        // unless explicitly hidden by JS later.

        startGameButton.addEventListener('click', () => {
            const playerName = playerNameInput.value.trim();
            if (playerName) {
                mainMenu.style.display = 'none';
                mainMenuBackground.style.display = 'none';
                gameCanvas.style.display = 'block'; // Show canvas
                resourceCounterContainer.style.display = 'flex'; // Show resource counters
                goldResourceDisplay.style.display = 'flex'; // Ensure gold display is visible
                console.log(`Starting game for player: ${playerName}`);
                // Here you would typically initialize your game engine
            } else {
                alert('Please enter your name to start the game!');
            }
        });

        // Basic resize handling for canvas (if needed for game logic)
        window.addEventListener('resize', () => {
            // If your game draws on canvas, you might need to redraw or adjust
            // canvas dimensions here based on the new window size.
            // For now, the CSS handles basic responsiveness.
        });

        /**
         * Updates the HTML resource counter display with current inventory values.
         * This function is called from main.js's game loop.
         * @param {object} inventory - An object containing resource counts (e.g., {wood: 10, stone: 5, gold: 20}).
         */
        window.updateHtmlResourceCounter = function(inventory) {
            if (goldCountSpan && inventory && typeof inventory.gold !== 'undefined') {
                goldCountSpan.textContent = inventory.gold;
            }
            // You can add logic here for other resources (wood, stone, food) if you have their respective spans
            // For example:
            // const woodCountSpan = document.getElementById('woodCount');
            // if (woodCountSpan && inventory && typeof inventory.wood !== 'undefined') {
            //     woodCountSpan.textContent = inventory.wood;
            // }
        };

        // Initialize gold count on page load (before game starts)
        if (goldCountSpan) {
            goldCountSpan.textContent = '0';
        }
    </script>
</body>
</html>
